<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Articles</title>
    <link rel="shortcut icon" href="images/favicon.png" type="image/x-icon"/>
    <link rel="icon" href="images/favicon.png" type="image/x-icon"/>
    <link rel="stylesheet" href="styles.css?v=1.1">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
</head>

<body class="articlesBody">
<header>
    <a href="#" class="logo"><img src="images/calicehockeylogo2.png" alt="California"></a>
    <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="schedule.html">Schedule</a></li>
        <li><a href="roster.html">Roster</a></li>
        <li><a href="staff.html">Staff</a></li>
        <li><a href="articles.html">Articles</a></li>
        <li class="dropdown">
            <a href="login.php">Team</a>
            <ul class="dropdown-menu">
                <li><a href="login.php">Login</a></li>
                <li><a href="https://forms.gle/nP5RbMVFuc2RLnWz9" target="_blank">Recruits</a></li>
                <li><a href="https://forms.gle/iUhuvuu1Cd8nx1Cd6" target="_blank">Alumni</a></li>
            </ul>
        </li>
    </ul>
</header>

<section class="banner articlesBanner">
    <video id="background-video" autoplay loop muted poster="images/ArticlesBanner.mp4">
        <source src="images/ArticlesBanner.mp4" type="video/mp4">
    </video>
</section>

<section class="articles">
    <div class="articlesHeading"></div>

    <!-- This stays the same class so your CSS keeps working -->
    <div class="articlesContainer" id="articlesContainer">
        <!-- JS will render thumbnails here -->
    </div>
</section>

<section class="rosterBottom">
    <section class="socialmediacontainer">
        <div class="FollowUs">Follow Us:</div>
        <div><a href="https://www.instagram.com/calicehockey/?utm_source=ig_web_button_share_sheet&igshid=OGQ5ZDc2ODk2ZA==" target="_blank"><img src="images/new-instagram-logo-white-border-icon-png-large.png" alt="Intagram"></a></div>
        <div><a href="https://www.tiktok.com/@californiaicehockey" target="_blank"><img src="images/tiktok-round-white-icon.webp" alt="TikTok"></a></div>
        <div><a href="https://x.com/Cal_IceHockey" target="_blank"><img src="images/x-social-media-white-round-icon.png" alt="X"></a></div>
    </section>
</section>

<script type="text/javascript">
    window.addEventListener("scroll", function(){
      var header = document.querySelector("header");
      header.classList.toggle("sticky", window.scrollY > 0);
    })
</script>

<script>
    const JSON_PATH = "articles.json"; // same folder as articles.html

    function escapeHtml(str) {
      return String(str ?? "")
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    function renderArticle(a) {
      const dateText = escapeHtml(a.dateText);
      const title = escapeHtml(a.title);
      const titleClass = escapeHtml(a.titleClass || "articleTitle");
      const excerpt = escapeHtml(a.excerpt);
      const image = escapeHtml(a.image);
      const href = escapeHtml(a.href);

      // identical structure to your existing thumbnails
      return `
        <div class="articleThumbnail">
          <div class="articleImg">
            <img src="${image}" alt="">
          </div>
          <div class="articleText">
            <span>${dateText}</span>
            <a href="${href}" class="${titleClass}">${title}</a>
            <p>${excerpt}</p>
            <a href="${href}">Read More</a>
          </div>
        </div>
      `;
    }

    async function loadArticles() {
      const container = document.getElementById("articlesContainer");
      if (!container) return;

      try {
        const res = await fetch(JSON_PATH, { cache: "no-store" });
        if (!res.ok) throw new Error(`Failed to load ${JSON_PATH}: ${res.status}`);

        const data = await res.json();
        const articles = Array.isArray(data.articles) ? data.articles : [];

        container.innerHTML = articles.map(renderArticle).join("");
      } catch (err) {
        console.error(err);
        container.innerHTML = `
          <div style="padding: 20px;">
            <p style="color: white;">Could not load articles.</p>
          </div>
        `;
      }
    }

    loadArticles();
</script>
</body>
</html>
